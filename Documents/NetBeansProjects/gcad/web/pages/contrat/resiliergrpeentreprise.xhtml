<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../../templates/layout.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:bnu="http://bootsfaces.net/ui"
                xmlns:p="http://primefaces.org/ui"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:define name="contenu">
        <h:form id="resiliepret">
            <p:growl id="growla"  showDetail="true" showSummary="false" autoUpdate="true" life="4000" />
           
            <p:panel header="RESILIATION DE CONTRAT GROUPE ENTREPRISE">
                <bnu:row>
                    <bnu:column col-md="12">
                        <h:panelGrid columns="1">
                            <p:selectOneMenu value="#{contratgroupeManagedBean.formContrat.idgroupe}" var="gpe"  converter="omnifaces.SelectItemsConverter" filter="true" filterMatchMode="contains" converterMessage="Conversion echoué">
                                <f:ajax execute="@this"  render="grid" listener="#{contratgroupeManagedBean.selectedgroupe()}"/>
                                <f:selectItem itemLabel="..Sélectionner groupe.." itemValue="" />
                                <f:selectItems value="#{groupeManagedBean.dataListGroupe}" var="item" itemLabel="#{item.libgroupe}" itemValue="#{item}"/>
                                <p:column>
                                    <h:outputText value="#{gpe.libgroupe}"/>
                                </p:column>
                                <p:column>
                                    <h:outputText value="#{gpe.telgroup}"/>
                                </p:column>
                                <p:column>
                                    <h:outputText value="#{gpe.emailgroup}"/>
                                </p:column>
                            </p:selectOneMenu>
                        </h:panelGrid>
                        <p:dataTable  style="margin-top: 7px" reflow="true" filteredValue="#{contratgroupeManagedBean.datalistefiltre}" widgetVar="branchetable" paginatorAlwaysVisible="false" id="grid"  styleClass="datatable" selectionMode="single" selection="#{contratgroupeManagedBean.selectrnouvelmentcontrat}" value="#{contratgroupeManagedBean.rnouvelmentcontrat}" var="item" rowKey="#{item.numpolice}" resizableColumns="true" paginator="true" rows="3" emptyMessage="aucun contrat trouvé">
                            <p:ajax event="rowSelect" update="@form:formule" listener="#{contratgroupeManagedBean.rowselectcontratresilie()}" />
                            <f:facet name="header">
                                <p:outputPanel>
                                    <h:outputText value="rechercher contrat : "   />
                                    <p:inputText id="globalFilter" onkeyup="PF('branchetable').filter()" size="30" style="margin-right: 3px;" placeholder="mot-clé(police)"/>
                                    <p:commandButton title="Rechercher"  update="@(.ui-datatable)" icon="ui-icon-search" />                                

                                </p:outputPanel>
                            </f:facet>
                            <p:column filterBy="#{item.numpolice}">
                                <f:facet name="header">
                                    <h:outputText value="police"/>
                                </f:facet>
                                <h:outputText value="#{item.numpolice}"/>
                            </p:column>
                            <p:column  filterBy="#{item.codassure.nomasusure}" filterMatchMode="contains" headerText="Nom assure">
                                <f:facet name="header">
                                    <h:outputText value=" nom assure"/>
                                </f:facet>
                                <h:outputText value="#{item.codassure.nomasusure}"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value=" prenoms"/>
                                </f:facet>
                                <h:outputText value="#{item.codassure.prenassure}"/>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Date effet"/>
                                </f:facet>
                                <h:outputText value="#{item.dateeffet}">
                                    <f:convertDateTime timeZone="CET" pattern="dd/MM/yyyy" />
                                </h:outputText>
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Date expiration"/>
                                </f:facet>
                                <h:outputText value="#{item.dateexp}">
                                    <f:convertDateTime timeZone="CET" pattern="dd/MM/yyyy" />
                                </h:outputText>
                            </p:column>

                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="Duree"/>
                                </f:facet>
                                <h:outputText value="#{item.durecontrat}"/>
                            </p:column>

                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="garantie"/>
                                </f:facet>
                                <h:outputText value="#{item.idgarantie.libgarantie}"/>
                            </p:column>

                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="modeayement"/>
                                </f:facet>
                                <h:outputText value="#{item.idmodeayement.libmodpayement}"/>
                            </p:column>


                        </p:dataTable>
           </bnu:column>
                </bnu:row>
                <p:separator/>
                <bnu:row>
                    <bnu:column col-md="7">
                        <p:panel id="formule" header="DETAIL DE LA POLICE" styleClass="panel">
                            <h:panelGrid columns="4">
                                <h:outputLabel value="Taux de prime : "/>
                                <pe:inputNumber style="width: 120px;margin-left: 2px"   decimalPlaces="3" decimalSeparator="." value="#{contratgroupeManagedBean.formrenvlmntcontrat.tauxprime}"/>

                                <h:outputLabel style="margin-left: 12px" value="Prime individuelle : "/>
                                <pe:inputNumber style="width: 120px;margin-left: 2px" symbol="FCFA" symbolPosition="s" decimalPlaces="0" decimalSeparator="." value="#{contratgroupeManagedBean.formrenvlmntcontrat.primemontant}"/>


                                <h:outputLabel value="Taux de supprime : "/>
                                <pe:inputNumber style="width: 120px;margin-left: 2px"  decimalPlaces="3" decimalSeparator="," value="#{contratgroupeManagedBean.formrenvlmntcontrat.tauxsupprime}"/>

                                <h:outputLabel style="margin-left: 12px" value="Prime nette  : "/>
                                <pe:inputNumber style="width: 120px;margin-left: 2px" symbol="FCFA" symbolPosition="s" decimalPlaces="0" decimalSeparator="." value="#{contratgroupeManagedBean.formrenvlmntcontrat.idgroupe.primegroup}"/>

                                <h:outputLabel value="Capital garanti : "/>
                                <pe:inputNumber style="width: 120px;margin-left: 2px" symbol="FCFA" symbolPosition="s" decimalPlaces="0" decimalSeparator="." value="#{contratgroupeManagedBean.formrenvlmntcontrat.capitgarantitotale}"/>

                                <h:outputLabel  style="margin-left: 12px" value="Prime TTC  : "/>
                                <pe:inputNumber readOnly="#{contratgroupeManagedBean.readonly}" style="width: 120px;margin-left: 2px" symbol="FCFA" symbolPosition="s" decimalPlaces="0" decimalSeparator="." value="#{contratgroupeManagedBean.formrenvlmntcontrat.idgroupe.primettcgroupe}"/>

                            </h:panelGrid>  



                        </p:panel>
                    </bnu:column>
                    <bnu:column col-md="5">
                        <p:panel header="RESILIATION-RADIATION">
                            <center>
                               <h:panelGrid columns="2">
                              
                                <h:outputLabel value="Prime a ristourner : "/>
                                <pe:inputNumber  style="width: 120px" value="#{contratgroupeManagedBean.formrenvlmntcontrat.primres}" decimalPlaces="0" decimalSeparator="." symbol="FCFA" symbolPosition="s"/>
                             
                                <h:outputLabel value="Situation du groupe : "/>
                                <p:inputText readonly="true"  style="width: 120px" value="#{contratgroupeManagedBean.formrenvlmntcontrat.idgroupe.situationgroup}" >
                                    <f:convertNumber maxFractionDigits="0" />
                                </p:inputText>
                             
                                </h:panelGrid>
                            
                                <h:panelGrid columns="3" style="margin-top: 15px">
                                    <p:commandButton styleClass="button" value="new" icon="ui-icon-refresh" />
                                    <p:commandButton update="@form" actionListener="#{contratgroupeManagedBean.resilier()}" styleClass="button" value="Valider" icon="ui-icon-check"/>
                                    <p:commandButton value="imprimer" icon="ui-icon-print"/>
                            </h:panelGrid>
                                </center>
                        </p:panel>
                    </bnu:column>
                </bnu:row>

            </p:panel>
        </h:form>
    </ui:define>

</ui:composition>
